do.call(coloc_nroi,arg)
}
if(DNA==FALSE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome)
do.call(coloc_ndna,arg)
}
if(DNA==FALSE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome)
do.call(coloc_ndnaroi,arg)
}
if(DNA==TRUE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc,arg)
}
}
coloc_wrapper(image_directory="/Users/samboulger/Desktop/Sen_Exp_Iba1",
results_directory="/Users/samboulger/Desktop/Sen_Exp_Iba1",
CoMarker_directory='/Users/samboulger/OneDrive - Nexus365/Imperial/CoMarker Script',
DNA=TRUE,
ROI=TRUE,
number_marker=2,
reference_marker="Iba1",
marker1="p16",
marker2='GLB1',
marker3='',
marker4='',
marker5='',
region_of_interest='GLUT1',
outcome='AD/CTRL',
remove_outliers=TRUE,
outliers_threshold='3.5')
library(blandr)
library(ggplot2)
library(readxl)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
Marker = 'Ab'
Ab_Counts <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B2:C24")
Ab_stats <- blandr.statistics(Ab_Counts$Manual, Ab_Counts$Script, sig.level = 0.95)
Ab_blandr <- blandr.draw(Ab_Counts$Manual, Ab_Counts$Script, ciDisplay = F, plotTitle = 'Bland-Altman Plot for Validation of CoMarker',
annotate = T)
Ab_blandr <- Ab_blandr + annotate('text', x = 12, y = 0.54, label= 'Upper Limit of Agreement = +1.96 SD')
Ab_blandr <- Ab_blandr + annotate('text', x = 12, y = -1.35, label= 'Lower Limit of Agreement = -1.96 SD')
Ab_blandr <- Ab_blandr + annotate('text', x = 13.5, y = -0.4, label= 'Mean Difference = -0.318')
Ab_blandr
library(blandr)
library(ggplot2)
library(readxl)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
Marker = 'Ab'
Ab_Counts <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "G6:H23")
Ab_stats <- blandr.statistics(Ab_Counts$Manual, Ab_Counts$Script, sig.level = 0.95)
Ab_blandr <- blandr.draw(Ab_Counts$Manual, Ab_Counts$Script, ciDisplay = F, plotTitle = 'Bland-Altman Plot for Validation of CoMarker',
annotate = T)
Ab_blandr <- Ab_blandr + annotate('text', x = 12, y = 0.54, label= 'Upper Limit of Agreement = +1.96 SD')
Ab_blandr <- Ab_blandr + annotate('text', x = 12, y = -1.35, label= 'Lower Limit of Agreement = -1.96 SD')
Ab_blandr <- Ab_blandr + annotate('text', x = 13.5, y = -0.4, label= 'Mean Difference = -0.318')
Ab_blandr
View(Ab_Counts)
library(blandr)
library(ggplot2)
library(readxl)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
Marker = 'Ab'
Ab_Counts <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "G6:H23")
Ab_stats <- blandr.statistics(Ab_Counts$Manual, Ab_Counts$Script, sig.level = 0.95)
View(Ab_Counts)
Ab_stats <- blandr.statistics(Ab_Counts$'3', Ab_Counts$'4', sig.level = 0.95)
View(Ab_stats)
View(Ab_stats)
View(Ab_Counts)
coloc_wrapper=function(image_directory,
results_directory,
CoMarker_directory,
DNA=TRUE,
ROI=TRUE,
number_marker=2,
reference_marker="Iba1",
marker1="CD68",
marker2='HLA-DR',
marker3='',
marker4='',
marker5='',
region_of_interest='Ab',
outcome='trem2_all',
remove_outliers=TRUE,
outliers_threshold=4){
library(tidyverse)
library(readr)
library(stringr)
library(dplyr)
library(rqdatatable)
library(rlist)
library(ggplot2)
library(gridExtra)
library(ggsignif)
library(ggpubr)
library(paletteer)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
source(paste0(CoMarker_directory,"Functions/coloc_nroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndnaroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndna.R"))
source(paste0(CoMarker_directory,"Functions/coloc.R"))
if(DNA==TRUE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_nroi,arg)
}
if(DNA==FALSE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndna,arg)
}
if(DNA==FALSE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndnaroi,arg)
}
if(DNA==TRUE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc,arg)
}
}
coloc_wrapper=function(image_directory,
metadata_directory,
results_directory,
CoMarker_directory,
DNA=TRUE,
ROI=TRUE,
number_marker=2,
reference_marker="Iba1",
marker1="CD68",
marker2='HLA-DR',
marker3='',
marker4='',
marker5='',
region_of_interest='Ab',
outcome='trem2_all',
remove_outliers=TRUE,
outliers_threshold=4){
library(tidyverse)
library(readr)
library(stringr)
library(dplyr)
library(rqdatatable)
library(rlist)
library(ggplot2)
library(gridExtra)
library(ggsignif)
library(ggpubr)
library(paletteer)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
source(paste0(CoMarker_directory,"Functions/coloc_nroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndnaroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndna.R"))
source(paste0(CoMarker_directory,"Functions/coloc.R"))
if(DNA==TRUE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_nroi,arg)
}
if(DNA==FALSE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndna,arg)
}
if(DNA==FALSE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndnaroi,arg)
}
if(DNA==TRUE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc,arg)
}
}
coloc_wrapper=function(image_directory,
metadata_directory,
results_directory,
CoMarker_directory,
DNA=TRUE,
ROI=TRUE,
number_marker=2,
reference_marker="Iba1",
marker1="CD68",
marker2='HLA-DR',
marker3='',
marker4='',
marker5='',
region_of_interest='Ab',
outcome='trem2_all',
remove_outliers=TRUE,
outliers_threshold=4){
library(tidyverse)
library(readr)
library(stringr)
library(dplyr)
library(rqdatatable)
library(rlist)
library(ggplot2)
library(gridExtra)
library(ggsignif)
library(ggpubr)
library(paletteer)
palette_choice <- paletteer::paletteer_d("ggsci::nrc_npg")
source(paste0(CoMarker_directory,"Functions/coloc_nroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndnaroi.R"))
source(paste0(CoMarker_directory,"Functions/coloc_ndna.R"))
source(paste0(CoMarker_directory,"Functions/coloc.R"))
if(DNA==TRUE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_nroi,arg)
}
if(DNA==FALSE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndna,arg)
}
if(DNA==FALSE && ROI==FALSE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc_ndnaroi,arg)
}
if(DNA==TRUE && ROI==TRUE){
arg=list(image_directory=image_directory,
results_directory=results_directory,
CoMarker_directory=CoMarker_directory,
number_marker=number_marker,
reference_marker=reference_marker,
marker1=marker1,
marker2=marker2,
marker3=marker3,
marker4=marker4,
marker5=marker5,
region_of_interest=region_of_interest,
outcome=outcome,
remove_outliers=remove_outliers,
outliers_threshold=outliers_threshold)
do.call(coloc,arg)
}
}
coloc_wrapper(image_directory="/Users/samboulger/Desktop/CoMarker/SampleDirectory/Images/",
results_directory="/Users/samboulger/Desktop/CoMarker/SampleDirectory/",
metadata_directory='/Users/samboulger/Desktop/CoMarker/SampleDirectory/Metadata/',
CoMarker_directory='/Users/samboulger/Desktop/CoMarker/',
DNA=TRUE,
ROI=TRUE,
number_marker=1,
reference_marker="Iba1",
marker1="CD68",
marker2='',
marker3='',
marker4='',
marker5='',
region_of_interest='Ab',
outcome='AD/CTRL',
remove_outliers=TRUE,
outliers_threshold=3.5)
install.packages('psych')
View(Blind_Manual_Counts)
library(readxl)
library(psych)
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
View(ICC_data)
ICC(ICC_data)
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
View(ICC_data)
ICC(ICC_data)
install.packages('irr')
library(irr)
icc(ICC_data, model = 'twoway', type = 'agreement', unit = 'single')
icc(ICC_data, model = 'twoway', type = 'consistency', unit = 'single')
plotICC(ICC_data)
?plotICC
??plotICC
??rmngb
install.packages('rmngb')
library(imngb)
library(rmngb)
library(ggplot2)
ggplot(ICC_data)
View(ICC_data)
ggplot(ICC_data, aes(x, y)) + geom_point()
library(tidyr)
lICC_data <- gather(ICC_data)
View(lICC_data)
View(ICC_data)
ICC_data$Image <- 1:nrows(ICC_data)
View(ICC_data)
ICC_data$Image <- 1:nrow(ICC_data)
View(ICC_data)
lICC_data <- gather(ICC_data)
View(ICC_data)
View(lICC_data)
View(lICC_data)
lICC_data <- gather(ICC_data)
View(lICC_data)
View(ICC_data)
lICC_data <- gather(ICC_data,Image)
View(lICC_data)
lICC_data <- gather(ICC_data,ICC_data$Image)
lICC_data <- gather(ICC_data)
View(lICC_data)
lICC_data <- gather(ICC_data, -Image)
icc(ICC_data, model = 'twoway', type = 'agreement', unit = 'single')
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
View(lICC_data)
View(ICC_data)
library(readxl)
library(ggplot2)
library(psych)
library(tidyr)
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
View(ICC_data)
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
setwd("~/")
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",range = "B27:D62")
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx$Manual Counts",range = "B27:D62")
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts$Manual Counts.xlsx",range = "B27:D62")
??read_excel
ICC_data <- read_excel("~/Library/CloudStorage/OneDrive-Nexus365/Imperial/Blind Manual Counts.xlsx",sheet = 'Manual Counts',range = "B27:D62")
library(irr)
icc(ICC_data, model = 'twoway', type = 'agreement', unit = 'single')
dumbbell(v1 = ICC_data$Sam, v2 = ICC_data$Hanaa, v3 = ICC_data$CoMarker,
text = TRUE, segments = TRUE, pch = 19,
pt.cex = 1.5, colv1 = 1, colv2 = "blue",colv3 = 'red')
install.packages('tidyverse')
library(tidyverse)
install.packages('dumbbell')
library(dumbbell)
dumbbell(v1 = ICC_data$Sam, v2 = ICC_data$Hanaa, v3 = ICC_data$CoMarker,
text = TRUE, segments = TRUE, pch = 19,
pt.cex = 1.5, colv1 = 1, colv2 = "blue",colv3 = 'red')
dumbbell(v1 = ICC_data$Sam, v2 = ICC_data$Hanaa,
text = TRUE, segments = TRUE, pch = 19,
pt.cex = 1.5, colv1 = 1, colv2 = "blue")
icc(ICC_data, model = 'twoway', type = 'agreement', unit = 'single')
setwd("~/Documents/GitHub/CoMarker")
bookdown::render_book('index.Rmd')
bookdown::render_book('index.Rmd')
bookdown::render_book('index.Rmd')
bookdown::render_book('index.Rmd')
