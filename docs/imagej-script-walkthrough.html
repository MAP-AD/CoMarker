<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 ImageJ Script Walkthrough | CoMarker | The Manual</title>
  <meta name="description" content="Chapter 3 ImageJ Script Walkthrough | CoMarker | The Manual" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 ImageJ Script Walkthrough | CoMarker | The Manual" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 ImageJ Script Walkthrough | CoMarker | The Manual" />
  
  
  

<meta name="author" content="Eléonore Schneegans1, Samuel Boulger1, Vicky Chau1, Nurun Fancy1, Johanna Jackson1, Paul M. Matthews1" />


<meta name="date" content="2022-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="imagefile-formatting.html"/>
<link rel="next" href="r-script-walkthrough.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CoMarker | The Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-purpose-of-comarker"><i class="fa fa-check"></i>The Purpose of CoMarker</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="functions-and-capabilities.html"><a href="functions-and-capabilities.html"><i class="fa fa-check"></i><b>1</b> Functions and Capabilities</a>
<ul>
<li class="chapter" data-level="1.1" data-path="functions-and-capabilities.html"><a href="functions-and-capabilities.html#what-does-comarker-do"><i class="fa fa-check"></i><b>1.1</b> What does CoMarker do?</a></li>
<li class="chapter" data-level="1.2" data-path="functions-and-capabilities.html"><a href="functions-and-capabilities.html#functionality-comparison"><i class="fa fa-check"></i><b>1.2</b> Functionality Comparison</a></li>
<li class="chapter" data-level="1.3" data-path="functions-and-capabilities.html"><a href="functions-and-capabilities.html#capabilities"><i class="fa fa-check"></i><b>1.3</b> Capabilities</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="imagefile-formatting.html"><a href="imagefile-formatting.html"><i class="fa fa-check"></i><b>2</b> Image/File Formatting</a>
<ul>
<li class="chapter" data-level="2.1" data-path="imagefile-formatting.html"><a href="imagefile-formatting.html#image-formatting"><i class="fa fa-check"></i><b>2.1</b> Image Formatting</a></li>
<li class="chapter" data-level="2.2" data-path="imagefile-formatting.html"><a href="imagefile-formatting.html#file-formatting"><i class="fa fa-check"></i><b>2.2</b> File Formatting</a></li>
<li class="chapter" data-level="2.3" data-path="imagefile-formatting.html"><a href="imagefile-formatting.html#metadata-formatting"><i class="fa fa-check"></i><b>2.3</b> Metadata Formatting</a></li>
<li class="chapter" data-level="2.4" data-path="imagefile-formatting.html"><a href="imagefile-formatting.html#example-directory-format"><i class="fa fa-check"></i><b>2.4</b> Example Directory Format</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html"><i class="fa fa-check"></i><b>3</b> ImageJ Script Walkthrough</a>
<ul>
<li class="chapter" data-level="3.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#specifying-parameters"><i class="fa fa-check"></i><b>3.1</b> Specifying Parameters</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#dialog-box-13"><i class="fa fa-check"></i><b>3.1.1</b> Dialog Box (1/3)</a></li>
<li class="chapter" data-level="3.1.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#dialog-box-23"><i class="fa fa-check"></i><b>3.1.2</b> Dialog Box (2/3)</a></li>
<li class="chapter" data-level="3.1.3" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#dialog-box-33"><i class="fa fa-check"></i><b>3.1.3</b> Dialog Box (3/3)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#region-of-interest"><i class="fa fa-check"></i><b>3.2</b> Region of Interest</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#overview-of-steps"><i class="fa fa-check"></i><b>3.2.1</b> Overview of Steps</a></li>
<li class="chapter" data-level="3.2.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#gaussian-blur"><i class="fa fa-check"></i><b>3.2.2</b> Gaussian Blur</a></li>
<li class="chapter" data-level="3.2.3" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#watershed-transform"><i class="fa fa-check"></i><b>3.2.3</b> Watershed Transform</a></li>
<li class="chapter" data-level="3.2.4" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#particle-analysis"><i class="fa fa-check"></i><b>3.2.4</b> Particle Analysis</a></li>
<li class="chapter" data-level="3.2.5" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#enlargement"><i class="fa fa-check"></i><b>3.2.5</b> Enlargement</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#nuclei"><i class="fa fa-check"></i><b>3.3</b> Nuclei</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#thresholding"><i class="fa fa-check"></i><b>3.3.1</b> Thresholding</a></li>
<li class="chapter" data-level="3.3.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#watershed"><i class="fa fa-check"></i><b>3.3.2</b> Watershed</a></li>
<li class="chapter" data-level="3.3.3" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#particle-analysis-1"><i class="fa fa-check"></i><b>3.3.3</b> Particle Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#reference-marker"><i class="fa fa-check"></i><b>3.4</b> Reference Marker</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#thresholding-1"><i class="fa fa-check"></i><b>3.4.1</b> Thresholding</a></li>
<li class="chapter" data-level="3.4.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#particle-analysis-2"><i class="fa fa-check"></i><b>3.4.2</b> Particle Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#colocalisation-markers"><i class="fa fa-check"></i><b>3.5</b> Colocalisation Markers</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#thresholding-2"><i class="fa fa-check"></i><b>3.5.1</b> Thresholding</a></li>
<li class="chapter" data-level="3.5.2" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#particle-analysis-3"><i class="fa fa-check"></i><b>3.5.2</b> Particle Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="imagej-script-walkthrough.html"><a href="imagej-script-walkthrough.html#output"><i class="fa fa-check"></i><b>3.6</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-script-walkthrough.html"><a href="r-script-walkthrough.html"><i class="fa fa-check"></i><b>4</b> R Script Walkthrough</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-script-walkthrough.html"><a href="r-script-walkthrough.html#necessary-r-packages"><i class="fa fa-check"></i><b>4.1</b> Necessary R Packages</a></li>
<li class="chapter" data-level="4.2" data-path="r-script-walkthrough.html"><a href="r-script-walkthrough.html#input-parameters"><i class="fa fa-check"></i><b>4.2</b> Input Parameters</a></li>
<li class="chapter" data-level="4.3" data-path="r-script-walkthrough.html"><a href="r-script-walkthrough.html#quality-control"><i class="fa fa-check"></i><b>4.3</b> Quality Control</a></li>
<li class="chapter" data-level="4.4" data-path="r-script-walkthrough.html"><a href="r-script-walkthrough.html#html-output"><i class="fa fa-check"></i><b>4.4</b> HTML Output</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="instructions---from-start-to-finish.html"><a href="instructions---from-start-to-finish.html"><i class="fa fa-check"></i><b>5</b> Instructions - From Start to Finish</a>
<ul>
<li class="chapter" data-level="5.1" data-path="instructions---from-start-to-finish.html"><a href="instructions---from-start-to-finish.html#download-the-repository"><i class="fa fa-check"></i><b>5.1</b> Download the Repository</a></li>
<li class="chapter" data-level="5.2" data-path="instructions---from-start-to-finish.html"><a href="instructions---from-start-to-finish.html#run-imagej"><i class="fa fa-check"></i><b>5.2</b> Run ImageJ</a></li>
<li class="chapter" data-level="5.3" data-path="instructions---from-start-to-finish.html"><a href="instructions---from-start-to-finish.html#run-r-studio"><i class="fa fa-check"></i><b>5.3</b> Run R Studio</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="instructions---using-the-command-line.html"><a href="instructions---using-the-command-line.html"><i class="fa fa-check"></i><b>6</b> Instructions - Using the Command Line</a>
<ul>
<li class="chapter" data-level="6.1" data-path="instructions---using-the-command-line.html"><a href="instructions---using-the-command-line.html#download-the-repository-1"><i class="fa fa-check"></i><b>6.1</b> Download the Repository</a></li>
<li class="chapter" data-level="6.2" data-path="instructions---using-the-command-line.html"><a href="instructions---using-the-command-line.html#input-parameters-1"><i class="fa fa-check"></i><b>6.2</b> Input Parameters</a></li>
<li class="chapter" data-level="6.3" data-path="instructions---using-the-command-line.html"><a href="instructions---using-the-command-line.html#open-a-terminal-window"><i class="fa fa-check"></i><b>6.3</b> Open a Terminal Window</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>7</b> Validation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="validation.html"><a href="validation.html#manual-counts-comparison"><i class="fa fa-check"></i><b>7.1</b> Manual Counts Comparison</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="validation.html"><a href="validation.html#cd68---colocalisation-marker"><i class="fa fa-check"></i><b>7.1.1</b> CD68 - Colocalisation Marker</a></li>
<li class="chapter" data-level="7.1.2" data-path="validation.html"><a href="validation.html#glut1---region-of-interest"><i class="fa fa-check"></i><b>7.1.2</b> GLUT1 - Region of Interest</a></li>
<li class="chapter" data-level="7.1.3" data-path="validation.html"><a href="validation.html#iba1---reference-marker"><i class="fa fa-check"></i><b>7.1.3</b> Iba1 - Reference Marker</a></li>
<li class="chapter" data-level="7.1.4" data-path="validation.html"><a href="validation.html#amyloid-beta---region-of-interest"><i class="fa fa-check"></i><b>7.1.4</b> Amyloid-beta - Region of Interest</a></li>
<li class="chapter" data-level="7.1.5" data-path="validation.html"><a href="validation.html#intraclass-correlation"><i class="fa fa-check"></i><b>7.1.5</b> Intraclass Correlation</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CoMarker | The Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="imagej-script-walkthrough" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> ImageJ Script Walkthrough<a href="imagej-script-walkthrough.html#imagej-script-walkthrough" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section of the manual will provide an overview of the steps taken in the ImageJ script, starting with the input parameters required for the script to function, followed by a walkthrough of how each marker is analysed.</p>
<div id="specifying-parameters" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Specifying Parameters<a href="imagej-script-walkthrough.html#specifying-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When the ImageJ script is ran, the following dialog boxes will appear one at a time, with the latter dialog boxes changing depending on the initial inputs. It is important to find parameters that work best for each marker. A useful resource for information about markers is the <a href="https://www.proteinatlas.org">Human Protein Atlas</a>. Checking what markers should look like will help to guide decisions on parameters such as minimum area and thresholding method.</p>
<div id="dialog-box-13" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Dialog Box (1/3)<a href="imagej-script-walkthrough.html#dialog-box-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="images/Dialog_1.png" width="400" alt="" />
<p class="caption">Dialog Box (1/3)</p>
</div>
<p><strong>Reference marker:</strong> Add here the name of the reference marker to be analysed. The name should match the image file name minus the ‘.tif’.</p>
<p><strong>Minimum area:</strong> This refers to the minimum number of pixels a marker signal is required to cover in order to be analysed. It is desired to eliminate as much noise as possible while keeping all relevant signal. It would be a good idea to look at a few sample images when determining the minimum area.</p>
<p><strong>Autothresholding method:</strong> Select an autothresholding method from the drop-down menu. See the thresholding section of this manual for more information.</p>
<p><strong>Has DNA marker:</strong> select “Yes” if a nuclei marker or present or “No” if not. The image name should always be ‘DNA.tif’.</p>
<p><strong>Has region of interest:</strong> “Yes” if the study involves a region of interest (ROI) or “No” if not.</p>
<p><strong>Number of markers to colocalise:</strong> Input here the number of markers that you wish to analyse in addition to the reference, nuclei and ROI markers.</p>
<p>Click ‘OK’ once done.</p>
</div>
<div id="dialog-box-23" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Dialog Box (2/3)<a href="imagej-script-walkthrough.html#dialog-box-23" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="images/Screenshot%202022-08-15%20at%2013.40.56.png" width="400" alt="" />
<p class="caption">Dialog Box (2/3)</p>
</div>
<p><strong>Marker colocalisation radius:</strong> this refers to the maximum proximity two markers can be in order to be deemed to be colocalised. This radius applies to reference marker-marker and (reference) marker-DNA colocalisation.</p>
<p><strong>Region of interest:</strong> Input the ROI marker here, ensuring that the name of the marker matches that in the file name.</p>
<p><strong>Use Gaussian and Watershed on ROI:</strong> Select either “Yes” or “No”. If “Yes”, this function blurs the ROI signal, before using a Watershed transform to segregate them. This is useful when the ROI signal is fragmented and is not densely populated within the region.</p>
<p><strong>ROI minimum area:</strong> If the answer was “Yes” to the previous input, then the minimum area should be higher as any gaps left by sparse markers will be filled by the blur.</p>
<p><strong>Radius around ROI:</strong> This allows for the region of interest to be expanded around the marker signal. If this is not desired set the value to 0.</p>
<p>Click ‘OK’ once done.</p>
</div>
<div id="dialog-box-33" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Dialog Box (3/3)<a href="imagej-script-walkthrough.html#dialog-box-33" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="images/Screenshot%202022-08-15%20at%2013.41.16.png" width="400" alt="" />
<p class="caption">Dialog Box (3/3)</p>
</div>
<p>State in this section the names of the markers to analyse, along with the minimum size and autothresholding method.</p>
<p>Click ‘OK’ once done.</p>
<p>Open the image directory in the pop-up finder.</p>
<p>The script will now run automatically.</p>
</div>
</div>
<div id="region-of-interest" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Region of Interest<a href="imagej-script-walkthrough.html#region-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="overview-of-steps" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Overview of Steps<a href="imagej-script-walkthrough.html#overview-of-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="images/ROI_steps.png" /></p>
</div>
<div id="gaussian-blur" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Gaussian Blur<a href="imagej-script-walkthrough.html#gaussian-blur" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Gaussian blur function takes the average of the signal in all pixels within a given radius. For our function, we use a radius of 5 pixels after extensive comparisons.</p>
<p>The blur is a means of resolving a problem faced when dealing with disperse or fragmented markers, such as amyloid-beta. Below is an example of the effects of the Gaussian blur on a slide stained for amyloid-beta.</p>
<p><img src="images/blur.png" /></p>
</div>
<div id="watershed-transform" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Watershed Transform<a href="imagej-script-walkthrough.html#watershed-transform" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Gaussian blur can cause clusters of signal to merge into each other so we use a watershed transform to separate those signals, as seen below.</p>
<p><img src="images/watershed.png" /></p>
</div>
<div id="particle-analysis" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Particle Analysis<a href="imagej-script-walkthrough.html#particle-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next step is to run the analyse particles function, using the specified minimum area. Below is the outcome of the optional Gaussian-watershed function with a default minimum area of 1100 pixels compared with the raw image. The sensitivity of the function can be modified by changing the minimum size.</p>
<p><img src="images/roi_analyse.png" /></p>
</div>
<div id="enlargement" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Enlargement<a href="imagej-script-walkthrough.html#enlargement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Find here an example of a 30 pixel enlargement on the region of interest. The extent of the enlargement is to be specified by the user.</p>
<p><img src="images/Screenshot%202022-08-15%20at%2017.27.40.png" width="350" /></p>
</div>
</div>
<div id="nuclei" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Nuclei<a href="imagej-script-walkthrough.html#nuclei" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/DNA_steps.png" /></p>
<div id="thresholding" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Thresholding<a href="imagej-script-walkthrough.html#thresholding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The chosen threshold ultimately determines how much signal is included in the processed image. Our default threshold for DNA is ‘Otsu’ as it is a good mid-range threshold which includes as much signal as possible whilst eliminating noise.</p>
<p>Otsu thresholding returns a single intensity threshold determined by minimizing intra-class intensity variance, or equivalently, by maximizing inter-class intensity variance.</p>
<div class="figure">
<img src="images/DNA_thresh.png" alt="" />
<p class="caption">DNA Threshold Montage</p>
</div>
</div>
<div id="watershed" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Watershed<a href="imagej-script-walkthrough.html#watershed" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The watershed transform is used here to separate overlapping DNA signal in the 2D image.</p>
<p><img src="images/DNA_watershed.png" /></p>
</div>
<div id="particle-analysis-1" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Particle Analysis<a href="imagej-script-walkthrough.html#particle-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>DNA signal is then counted and analysed. Each DNA count represents a cluster of touching pixels with an area larger than the specified minimum area. We have set the default minimum area as 4 pixels due to some cells having nuclei with a diameter as small as 2 microns, thereby covering at least 4 pixels. Most nuclei, however, are larger than this, so it may be beneficial to increase the minimum area depending on the study.</p>
</div>
</div>
<div id="reference-marker" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Reference Marker<a href="imagej-script-walkthrough.html#reference-marker" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/ref_steps.png" /></p>
<div id="thresholding-1" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Thresholding<a href="imagej-script-walkthrough.html#thresholding-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our default threshold for the reference marker is ‘Otsu’ as it is a good mid-range threshold which includes as much signal as possible whilst eliminating noise.</p>
<div class="figure">
<img src="images/Iba1_thresh.png" alt="" />
<p class="caption">Iba1 Threshold Montage</p>
</div>
</div>
<div id="particle-analysis-2" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Particle Analysis<a href="imagej-script-walkthrough.html#particle-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Reference marker-positive cells are identified by overlaying enlarged reference marker signal and DNA. Here, we present several close-up images to display how the script recognises each positive cell and avoids false positives/negatives. The images show our reference marker (Iba1) in red, merged with DNA in cyan.</p>
<p><img src="images/ref_cell1.png" width="400" /></p>
<p><img src="images/ref_cell2.png" width="410" /></p>
<p><img src="images/ref_cell3.png" width="400" /></p>
<div class="figure">
<img src="images/ref_cell4.png" width="400" alt="" />
<p class="caption">Despite tightly clustered DNA, only the correct cells are counted.</p>
</div>
<div class="figure">
<img src="images/ref_cell5.png" width="410" alt="" />
<p class="caption">Cell only counted once (same colour overlay) despite fragmented signal.</p>
</div>
<p>Reference marker cells within the ROI are simply these detected cells which are situated within the enlarged region of interest.</p>
</div>
</div>
<div id="colocalisation-markers" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Colocalisation Markers<a href="imagej-script-walkthrough.html#colocalisation-markers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/marker_steps.png" /></p>
<p>This section of the code is identical for each of the colocalisation markers used, however different minimum areas and thresholds can be used.</p>
<div id="thresholding-2" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Thresholding<a href="imagej-script-walkthrough.html#thresholding-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The default threshold is again set to ‘Otsu’ which we recommend due to its balance between removing noise and retaining useful signal. It is important, however, that different thresholds for each marker. Thresholding montages can be produced in FIJI ImageJ through Image -&gt; Adjust -&gt; Auto Threshold -&gt; Try All. Find here a few example thresholding montages.</p>
<div class="figure">
<img src="images/CD68_thresh.png" alt="" />
<p class="caption">CD68 Thresholding Montage</p>
</div>
<div class="figure">
<img src="images/HLA-DR_thresh.png" alt="" />
<p class="caption">HLA-DR Thresholding Montage</p>
</div>
<div class="figure">
<img src="images/pTau_thresh.png" alt="" />
<p class="caption">pTau Thresholding Montage</p>
</div>
</div>
<div id="particle-analysis-3" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Particle Analysis<a href="imagej-script-walkthrough.html#particle-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Colocalisation marker-positive cells by the same processes as reference markers. (See here <a href="imagej-script-walkthrough.html#particle-analysis-3">Particle Analysis</a>).</p>
</div>
</div>
<div id="output" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Output<a href="imagej-script-walkthrough.html#output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The ImageJ script output consists of a results table for every replicate. These results tables are collated and read by the R script.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="imagefile-formatting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-script-walkthrough.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/eleonore-schneeg/CoMarker/edit/master/04-ImageJ_walkthrough.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/eleonore-schneeg/CoMarker/blob/master/04-ImageJ_walkthrough.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
